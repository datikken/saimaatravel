var app=app||{};app.breakpoints={tablet:768,medium:992,large:1120},function(){"use strict";var t,e=0,i=0,a=0,s=!1;app.vars={windowWidth:0,windowHeight:0,breakpointState:1,trueResize:!1,heightResize:!1,homeUrl:"/",authorized:!1,ios:!1},app.EVENTS={INIT_COMPLETE:"init-complete"},app.classes={no_transition:"transition-instant"},app.selectors={body:"body",navbar:".navbar",header:".header",main:".main",map:".map-wrap",lead:".cta",footer:".footer"},app.elements={},app.tree_data="",app.modules=[],app.init=function(){s||(s=!0,t=$(window),this.vars.langGuid=$(this.selectors.body).data("langGuid"),this.vars.authorized=$(this.selectors.body).hasClass("authorized"),this.vars.windowWidth=t.outerWidth(),this.vars.windowWidth>=app.breakpoints.tablet&&(this.vars.breakpointState=2),this.vars.windowWidth>=app.breakpoints.medium&&(this.vars.breakpointState=3),this.vars.windowWidth>=app.breakpoints.large&&(this.vars.breakpointState=4),navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&(this.vars.ios=!0),this.modulesInit(),this.listener(),this.resize(),this._loadState())},app.modulesInit=function(){for(var t in app)app.hasOwnProperty(t)&&(_.isObject(app[t])||_.isFunction(app[t]))&&_.isFunction(app[t].init)&&this.modules.push(app[t]);this.modules=_.sortBy(this.modules,function(t){return t.moduleOrder}),_.each(this.modules,function(t){t.init()})},app.listener=function(){var e=$("body");t.resize(this._handleResize.bind(this)),e.on("submit",".ajax-form","lenmgt_main",this.formSubmit.bind(this)),e.on("submit","form","lenmgt_main",this.formStaticSubmit.bind(this))},app.formParse=function(t){var e={},i=t.serializeArray();return _.each(i,function(t){-1!==t.name.indexOf("phone")&&0==t.value.indexOf("+")&&(t.value=t.value.replace(/\s/g,"")),e[t.name]=t.value}),e},app.formStaticSubmit=function(t){var e,i=$(t.currentTarget);i.hasClass("handled")||i.hasClass("ajax-form")||i.data("valid")||(t.preventDefault(),e=app.validator.formValidate([],i),i.data("valid",e),e&&!i.hasClass("prevalidate")&&app.prevalidateForm(t))},app.elementsParse=function(t,e){var i=$(e).length?$(e):$("body"),a={};return _.each(t,function(t,e){var s=i.find(t);s.length?a[e]=s:i.is(t)?a[e]=i:a[e]=s}),a},app.formSubmit=function(t){var e=$(t.currentTarget);t.preventDefault(),e.hasClass("handled")||(e.hasClass("prevalidate")?e.ajaxSubmit({beforeSubmit:function(t,e,i){var a=app.validator.formValidate(t,e);return e.toggleClass("preload",a),a},success:function(t,e,i,a){t?($(a).parent().html(t),$(a).parent().addClass("form-success")):$(a).parent().addClass("form-error")},error:function(){$(e).parent().addClass("form-error")}}):this.prevalidateForm(t))},app.prevalidateForm=function(t){var e=$(t.currentTarget);if(t.preventDefault(),t.stopPropagation(),!e.find(".validate_action"))return e.addClass("prevalidate"),e.submit(),!0;e.ajaxSubmit({success:function(t,e,i,a){var s=i.getResponseHeader("validationHash");s&&a.append('<input type="hidden" value="'+s+'" name="validationHash" />'),a.find(".validate_action").remove(),a.addClass("prevalidate"),a.submit()}})},app._handleResize=function(){e&&clearTimeout(e),e=setTimeout(function(){app.resize()}.bind(this),100)},app.resize=function(){for(var e in this.vars.windowWidth=t.outerWidth(),this.vars.windowHeight=t.outerHeight(),(app.vars.windowHeight-i>=100||app.vars.windowHeight-i<=-100||a!==app.vars.windowWidth)&&(app.vars.trueResize=!0),a===app.vars.windowWidth&&i!==app.vars.windowHeight&&(app.vars.heightResize=!0),i=app.vars.windowHeight,a=app.vars.windowWidth,this.vars.breakpointState=1,this.vars.windowWidth>=app.breakpoints.tablet&&(this.vars.breakpointState=2),this.vars.windowWidth>=app.breakpoints.medium&&(this.vars.breakpointState=3),this.vars.windowWidth>=app.breakpoints.large&&(this.vars.breakpointState=4),app)app.hasOwnProperty(e)&&(_.isObject(app[e])||_.isFunction(app[e]))&&_.isFunction(app[e].resize)&&app[e].resize();app.vars.trueResize=!1,app.vars.heightResize=!1},app.getItemsByAPI=function(t,e,i){var a,s,n="sessionStorage"in window&&window.sessionStorage,o=t,r=!1;try{n&&(r=sessionStorage.getItem(o))&&(r=JSON.parse(r),a=new Date,(s=new Date(r.timestamp)).setMinutes(s.getMinutes()+15),a.getTime()>s.getTime()&&(r=!1,sessionStorage.removeItem(o)))}catch(t){r=!1}r?i&&_.isFunction(i)&&i(r.content):$.ajax({type:"GET",url:"/",data:{api:e},success:function(t,a,s){if("error"!==t.status){if(n)try{sessionStorage.setItem(o,JSON.stringify({timestamp:new Date,content:t}))}catch(t){}i&&i(t)}else console.error("При выполнении API запроса к "+e+" произошла ошибка",t)},error:function(t){console.error("При выполнении API запроса к "+e+" произошла ошибка",t)}})},app.convertDateForHumans=function(t,e){var i,a,s=new Date;return e||(e=1),s.setTime(1e3*t*e),i=(i=s.getMinutes())<10?"0"+i:i,a=s.getHours()+":"+i,{year:s.getYear()+1900,month:s.getMonth(),days:s.getDate(),time:a}},app.isMobile=function(){return 1===this.vars.breakpointState},app.Module=function(t){this._init=!1,this._instances=[],this._container_selector=t.prototype._selectors.container,this.ModuleFactory=t},app.Module.prototype={init:function(t){t||(t=$(this._container_selector)),t.length&&(this._init=!0,t.each(function(t,e){var i=new this.ModuleFactory($(e));this._instances.push(i)}.bind(this)))},resize:function(){this._init&&_.each(this._instances,function(t){t.resize()})}},app._loadState=function(){$("body").trigger(app.EVENTS.INIT_COMPLETE),$("body").addClass("app-load")}}(),$(document).ready(function(){app.init()}),function(){"use strict";app.carousel={_selectors:{container:".owl-carousel"},_init:!1,init:function(){$(this._selectors.container).length&&(this._init=!0,this._listener())},_listener:function(){$(document).ready(this._init_gallery.bind(this))},_handleSwipe:function(t){t.gesture&&t.gesture.direction&&(2===t.gesture.direction&&$("#dg-container").find(".dg-next").click(),4===t.gesture.direction&&$("#dg-container").find(".dg-prev").click())},_init_gallery:function(){$(".owl-carousel").owlCarousel({loop:!0,margin:0,dots:!1,nav:!0,responsiveClass:!0,responsive:{0:{items:1,margin:20,stagePadding:0,singleItem:!0},600:{items:2,margin:20,stagePadding:50},1000:{items:3,margin:40,stagePadding:0}}})},resize:function(){this._init&&app.vars.trueResize}}}(),function(){"use strict";app.navbar={_selectors:{container:".navbar"},_init:!1,init:function(){$(this._selectors.container).length&&(this._init=!0,this._listener())},_listener:function(){$(document).ready(this._rotate.bind(this)),$("#menu__toggle").on("click",this._dropMenu.bind(this))},_dropMenu:function(){$(".dropdown__overlay").toggleClass("show__menu"),$(".dropdown__overlay").toggleClass("hide__menu");var t=$(".site")[0];$(t).hasClass("blocked")?this._allowScroll():this._blockScroll()},_blockScroll:function(){scrollLock.disablePageScroll(),$(".site").addClass("blocked")},_allowScroll:function(){scrollLock.enablePageScroll(),$(".site").addClass("enabled"),$(".site").removeClass("blocked")},_rotate:function(){$(".dropdown-toggle").on("click",function(t){$(".arrow").toggleClass("rotate"),$(".arrow").toggleClass("rotate2"),$(".dropdown-menu").toggleClass("hidden"),$(".dropdown-menu").toggleClass("shown")})},resize:function(){this._init&&app.vars.trueResize}}}(),function(){"use strict";app.lead={_selectors:{container:".cta"},_init:!1,init:function(){$(this._selectors.container).length&&(this._init=!0,this._listener())},_listener:function(){$(".cta").on("click",this._showForm.bind(this)),$(".close").on("click",this._hideForm.bind(this))},_showForm:function(){$("body").css("overflow","hidden"),$(".overlay").css("visibility","visible"),$(".overlay").css("opacity","1"),$(".site").css("overflow","hidden"),$(".site").css("position","fixed")},_hideForm:function(){$("body").css("overflow","initial"),$(".overlay").css("visibility","hidden"),$(".overlay").css("opacity","0"),$(".site").css("overflow","initial"),$(".site").css("position","initial")},resize:function(){this._init&&app.vars.trueResize}}}(),function(){"use strict";app.map={_selectors:{container:".map"},_init:!1,init:function(){$(this._selectors.container).length&&(this._init=!0,this._listener())},_listener:function(){$(document).ready(this._simpleMap.bind(this))},_simpleMap:function(){ymaps.ready(function(){var t,e=$(".map");console.log(e),$(e).each(function(e,i){(t=new ymaps.Map(i,{center:[55.76,37.64],zoom:17,type:"yandex#map",behaviors:["default","scrollZoom"]})).balloon.open([i.dataset.lat,i.dataset.lng],{contentHeader:i.dataset.desc,contentBody:"",contentFooter:i.dataset.adress},{closeButton:!1});var a=new ymaps.Placemark([i.dataset.lat,i.dataset.lng],{balloonCloseButton:!0,hideIconOnBalloonOpen:!0},{preset:"islands#circleDotIcon",iconColor:"#333"});t.geoObjects.add(a)})})},resize:function(){this._init&&app.vars.trueResize}}}();